---
title: "ASP.NET通过使用Membership管理用户(1):Membership介绍"
date: 2005-12-28 16:25:00
layout: post
categories: aspnet
tags: aspnet
---

ASP.NET成员为你提供了一套内置的验证和存储用户信任的方法。因此，ASP.NET成员可以帮助你在你的Web应用当中管理用户验证。你可以在Forms验证的时候使用ASP.NET成员，也可以在通过登录控件来创建一整套用户管理系统。

ASP.NET成员轻松支持如下特性：

* 创建用户和密码
* 在微软SQLServer、AD或者其他数据源当中存储成员信息（用户名，密码和其他数据）
* 鉴别访问站点的用户。你可以按照自己的意愿鉴别用户，也可以通过ASP.NET登录控件不编写代码或者很少编写来创建一整套用户鉴别系统。
* 管理密码，包括创建、更改和重设密码。依赖于你设置的membership选项，membership系统提供自动实现基于用户提供的问答来重设密码的实现。
* 为鉴别过的用户提供一个唯一的标识，以便你能把这些标识应用在你的应用系统的个性化和规则系统（授权）系统当中。
* 定制特殊的成员provider，允许你用自己的代码替代并管理和维护存储在定制数据存储中的成员数据。

### 成员，规则和用户配置

虽然成员是ASP.NET用户鉴定的一个半独立特性，但是它可以与ASP.NET规则管理整合，以此为你的站点提供授权服务。成员也可以与用户配置相整合，以此提供针对用户的特殊应用细节。详细内容请参考“使用规则管理授权”和“ASP.NET配置属性”。

### Membership如何工作

如果要使用成员，必须首先在站点中配置。大体上需要如下的步骤：

1. 在你的站点配置添加成员配置参数。默认情况下，成员是被打开的。你也可以指定自己使用的成员provider。（对于实践的时候来讲，就是指定你想用以保存用户信息的数据库。）默认的provider是微软SQL Server数据库。你也可以选择AD来存储成员信息，或者你自己指定一个特定的provider。如果要得到更多关于在你的ASP.NET应用的`Web.config`文件中配置成员的信息，请参考“配置ASP.NET应用使用Membership”。
2. 配置你的应用使用Forms鉴别（区别于Windows或者Passport鉴别）。你代表性的可以指定应用中的某些页和文件夹是受保护的，只有经过鉴别的用户才可以访问。
3. 定义成员的用户帐号。你可以通过两种方法完成这个步骤。你可以使用Web站点管理工具提供的向导页面来创建新用户。你可以通过ASP.NET页来自己收集用户名、密码（邮件地址可选），然后使用成员功能提供的`CreateUser`方法在成员系统当中创建新用户。

你可以在你的应用当中使用成员鉴别用户。大多数情况下，你需要提供一个登录窗口，他可以是一个隔离的页或者隔离的文件夹。你可以使用ASP.NET的TextBox控件手动创建登录窗口，也可以使用ASP.NET的登录控件。因为你配置应用使用Forms鉴别，所以当用户在访问受保护的页面的时候，ASP.NET将自动显示登录页。

> 注释：
>
> ASP.NET的登录控件（`Login`、`LoginView`、`LoginStatus`、`LoginName`和`PasswordRecovery`）包含了所有的事实上需要的所有成员系统的受信任用户的提示和验证用户信用的逻辑。

如果你使用登录控件，这些登录控件将自动使用成员系统来验证用户。如果你自己手动创建一个登录窗口，你可以提示用户提交一个用户名和密码，然后调用ValidateUser方法来执行用户确认。在用户被确认以后，用户的相关信息可以一直在Forms鉴别当中使用（例如：如果用户的浏览器接受cookies，将使用加密的cookie）。登录控件将自动执行这个任务，如果你手动创建登录窗口，你必须调用`FormsAuthentication`对象的方法来创建cookies，并写入用户的电脑。如果用户忘记了他的密码，登录窗口也可以调用成员的功能来帮助用户可以回忆起密码或者创建一个新的密码。