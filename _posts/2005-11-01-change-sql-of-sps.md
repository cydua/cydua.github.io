---
title: "更换SPS的数据库的方法"
date: 2005-11-01 15:37:00
layout: post
categories: SharePoint
tags: SharePoint
---

记录一次更换SPS的数据库的方法。

* 场景：
  
  用户的SQL Server 2000服务器需要扩容，原本想做SQL Server服务器群，后来客户决定从新建SQL Server服务器，SPS使用新的SQL Server 2000服务器。

* 方法：

  1. 在“配置服务器场拓扑结构”中去掉服务器场中所有的服务器角色的设置。
  2. 在“指定配置数据库服务器”中断开与当前的数据库服务器的连接。
  3. 将旧的数据库实例暂停，复制SPS的配置数据库和内容数据库的数据文件和事务日志文件到新的数据库实例上面上。
  4. 在新的数据库实例上面创建配置数据库和内容数据库。数据库的名称不能改变。
  5. 在新的数据库实例上配置新的帐号。帐号应使用原来的数据库帐号。
  6. 回到SPS的“指定配置数据库服务器”，当中按照“连接到现有的配置数据库”进行配置。
  7. 重新启动“SSO”服务，并将服务改为“自动”。
  8. 重新启动SPS服务器。

> 说明：第8步，不知道什么服务需要新启动，所以干脆重新启动了服务器。各位同学可以试试看，到底是哪个服务器需要重新启动。

由于以上的方法纯属实践得来，没有在各种服务器场环境上进行测试，所以本人不为任何的实验行为带来的后果负责。实验前请做备份。